<!DOCTYPE html>
<html lang="en">
	<head>
		<title>three.js webgl - animation - keyframes</title>
		<meta charset="utf-8" />
		<meta
			name="viewport"
			content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
		/>
		<link type="text/css" rel="stylesheet" href="main.css" />
		<style>
			body {
				background-color: #bfe3dd;
				color: #000;
			}

			a {
				color: #2983ff;
			}
		</style>
	</head>

	<body>
		<div id="container"></div>

		<div id="info">
			<a href="https://threejs.org" target="_blank" rel="noopener">three.js</a>
			webgl - animation - keyframes<br />
			Model:
			<a
				href="https://artstation.com/artwork/1AGwX"
				target="_blank"
				rel="noopener"
				>Littlest Tokyo</a
			>
			by
			<a href="https://artstation.com/glenatron" target="_blank" rel="noopener"
				>Glen Fox</a
			>, CC Attribution.
		</div>

		<script type="importmap">
			{
				"imports": {
					"three": "../build/three.module.js",
					"three/addons/": "./jsm/"
				}
			}
		</script>

		<script type="module">
			import * as THREE from "three";

			import Stats from "three/addons/libs/stats.module.js";

			import { OrbitControls } from "three/addons/controls/OrbitControls.js";
			import { RoomEnvironment } from "three/addons/environments/RoomEnvironment.js";

			import { GLTFLoader } from "three/addons/loaders/GLTFLoader.js";
			import { DRACOLoader } from "three/addons/loaders/DRACOLoader.js";

			// 创建场景
			// 初始化Three.js场景
			const scene = new THREE.Scene();
			const camera = new THREE.PerspectiveCamera(
				75,
				window.innerWidth / window.innerHeight,
				0.1,
				1000
			);
			const renderer = new THREE.WebGLRenderer();
			renderer.setSize(window.innerWidth, window.innerHeight);
			document.body.appendChild(renderer.domElement);

			// 存储墙体的点集合
			const wallPoints = [];
			let isDrawing = false;

			// 监听鼠标事件
			document.addEventListener("mousedown", (event) => {
				if (event.button === 0) {
					isDrawing = true;
					wallPoints.push(new THREE.Vector2(event.clientX, event.clientY));
				}
			});

			document.addEventListener("mousemove", (event) => {
				if (isDrawing) {
					wallPoints.push(new THREE.Vector2(event.clientX, event.clientY));
				}
			});

			document.addEventListener("mouseup", (event) => {
				if (event.button === 2) {
					// 鼠标右击
					isDrawing = false;

					// 创建墙体的几何对象
					const wallGeometry = new THREE.BufferGeometry().setFromPoints(
						wallPoints
					);

					// 创建墙体的材质
					const wallMaterial = new THREE.LineBasicMaterial({ color: 0x00ff00 });

					// 创建墙体的线段
					const wall = new THREE.Line(wallGeometry, wallMaterial);

					// 添加墙体到场景中
					scene.add(wall);

					// 清空点集合，准备绘制下一段墙体
					wallPoints.length = 0;
				}
			});

			// 初始化相机位置
			camera.position.z = 5;

			// 渲染函数
			const animate = () => {
				requestAnimationFrame(animate);
				renderer.render(scene, camera);
			};

			// 开始渲染循环
			animate();
		</script>
	</body>
</html>
